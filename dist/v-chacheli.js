!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["v-chacheli"]=e():t["v-chacheli"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=21)}([function(t,e){t.exports=function(t,e,i,n,a,r){var s,c=t=t||{},o=typeof t.default;"object"!==o&&"function"!==o||(s=t,c=t.default);var l="function"==typeof c?c.options:c;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0),i&&(l.functional=!0),a&&(l._scopeId=a);var h;if(r?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=h):n&&(h=n),h){var d=l.functional,u=d?l.render:l.beforeCreate;d?(l._injectStyles=h,l.render=function(t,e){return h.call(e),u(t,e)}):l.beforeCreate=u?[].concat(u,h):[h]}return{esModule:s,exports:c,options:l}}},function(t,e,i){"use strict";var n=i(8),a=i(14);e.a={name:"chacheli-designer",components:{ChacheliDesignerLayout:n.a,ChacheliChooser:a.a},props:["layout","chachelis"],data:function(){return{dragging:{active:!1,cancelled:!1,index:0}}},methods:{minColumns:function(){return this.$refs.layoutComp.minColumns()},minRows:function(){return this.$refs.layoutComp.minRows()}}}},function(t,e,i){"use strict";var n=i(10);e.a={name:"chacheli-designer-layout",components:{Chacheli:n.a},props:["layout","chachelis","dragging"],data:function(){return{placeholder:{interaction:"resize",hidden:!0,invalid:!1,unit:"px",t:0,l:0,w:1,h:1},units:{v:0,h:0}}},computed:{placeholderStyle:function(){return{top:this.placeholder.t+this.placeholder.unit,left:this.placeholder.l+this.placeholder.unit,width:this.placeholder.w+this.placeholder.unit,height:this.placeholder.h+this.placeholder.unit}},interactClass:function(){return this.placeholder.hidden?"":"interact "+this.placeholder.interaction}},watch:{"layout.cols":function(){this.calc()},"layout.rows":function(){this.calc()},"dragging.active":function(t){t?this.dragStart():this.dragEnd()}},created:function(){this.calc(),this.interact={chacheli:null,handler:null,x0:0,y0:0,l0:0,t0:0,w0:0,h0:0,xu:0,yu:0,grid:null,dragging:0}},methods:{calc:function(){this.units.v=100/this.layout.rows,this.units.h=100/this.layout.cols},resizeStart:function(t){this.interactStart(t,"resize",this.resizeMove)},resizeMove:function(t){this.placeholder.w=this.interact.w0+t.clientX-this.interact.x0,this.placeholder.h=this.interact.h0+t.clientY-this.interact.y0,this.maybeUpdateChacheli(this.interact.chacheli.x,this.interact.chacheli.y,Math.max(1,Math.round(this.placeholder.w/this.interact.xu)),Math.max(1,Math.round(this.placeholder.h/this.interact.yu)))},positionStart:function(t){this.interactStart(t,"drag",this.positionMove)},positionMove:function(t){this.placeholder.l=this.interact.l0+t.clientX-this.interact.x0,this.placeholder.t=this.interact.t0+t.clientY-this.interact.y0,this.maybeUpdateChacheli(Math.round(this.placeholder.l/this.interact.xu),Math.round(this.placeholder.t/this.interact.yu),this.interact.chacheli.w,this.interact.chacheli.h)},dragStart:function(){this.interact.dragging=!1,this.$el.addEventListener("mouseenter",this.dragEnter,!1),this.$el.addEventListener("mouseleave",this.dragLeave,!1),this.$el.addEventListener("mousemove",this.dragOver,!1)},dragEnter:function(t){this.dragging.active&&(this.interact.dragging=!0,this.interact.x0=this.interact.y0=-1,this.placeholder.unit="%",this.placeholder.hidden=!1,this.placeholder.interaction="dnd",this.placeholder.invalid=!1,this.placeholder.w=this.units.h,this.placeholder.h=this.units.v,this.createValidationGrid(null),this.calcInteractUnits(),this.dragOver(t))},dragOver:function(t){var e=this.$el.getBoundingClientRect(),i=Math.floor((t.clientX-e.left)/this.interact.xu),n=Math.floor((t.clientY-e.top)/this.interact.yu);i==this.interact.x0&&n==this.interact.y0||(this.interact.x0=i,this.interact.y0=n,this.placeholder.l=i*this.units.h,this.placeholder.t=n*this.units.v,this.placeholder.invalid=!this.validateChacheli(i,n,1,1))},dragLeave:function(){this.placeholder.hidden=!0,this.interact.dragging=!1},dragEnd:function(){if(this.$el.removeEventListener("mouseenter",this.dragEnter,!1),this.$el.removeEventListener("mouseleave",this.dragLeave,!1),this.$el.removeEventListener("mousemove",this.dragOver,!1),this.interactCleanup(),this.interact.dragging&&!this.dragging.cancelled&&!this.placeholder.invalid){var t=this.chachelis[this.dragging.index];t&&t.available&&(t.available=!1,t.x=this.interact.x0,t.y=this.interact.y0,t.w=t.h=1)}},interactStart:function(t,e,i){this.placeholder.unit="px",this.placeholder.hidden=!1,this.placeholder.invalid=!1,this.placeholder.interaction=e,this.placeholder.t=this.interact.t0=t.initialPos.top,this.placeholder.l=this.interact.l0=t.initialPos.left,this.placeholder.w=this.interact.w0=t.initialPos.width,this.placeholder.h=this.interact.h0=t.initialPos.height,this.interact.x0=t.event.clientX,this.interact.y0=t.event.clientY,this.interact.chacheli=t.chacheli,this.interact.handler=i,this.calcInteractUnits(),this.createValidationGrid(t.chacheli),document.documentElement.addEventListener("mousemove",this.interact.handler,!1),document.documentElement.addEventListener("mouseup",this.interactStop,!1)},interactStop:function(){document.documentElement.removeEventListener("mousemove",this.interact.handler,!1),document.documentElement.removeEventListener("mouseup",this.interactStop,!1),this.interactCleanup()},calcInteractUnits:function(){var t=document.defaultView.getComputedStyle(this.$el);this.interact.xu=Math.floor(parseInt(t.width)/this.layout.cols),this.interact.yu=Math.floor(parseInt(t.height)/this.layout.rows)},createValidationGrid:function(t){var e=parseInt(this.layout.rows),i=parseInt(this.layout.cols);this.interact.grid=new Array(e);for(var n=0;n<e;n++)for(var a=this.interact.grid[n]=new Array(i),r=0;r<i;r++)a[r]=1;for(var s=0;s<this.chachelis.length;s++){var c=this.chachelis[s];if(c!==t&&!c.available)for(var o=0;o<c.h;o++)for(var l=0;l<c.w;l++)this.interact.grid[c.y+o][c.x+l]=0}},validateChacheli:function(t,e,i,n){for(var a=0;a<n;a++)for(var r=0;r<i;r++){var s=this.interact.grid[e+a];if(!s||!s[t+r])return!1}return!0},maybeUpdateChacheli:function(t,e,i,n){var a=this.interact.chacheli;if(a.x==t&&a.y==e&&a.w==i&&a.h==n)return void(this.placeholder.invalid=!1);this.validateChacheli(t,e,i,n)?(a.x=t,a.y=e,a.w=i,a.h=n,this.placeholder.invalid=!1):this.placeholder.invalid=!0},interactCleanup:function(){this.placeholder.hidden=!0,this.interact.chacheli=null,this.interact.grid=null},minColumns:function(){for(var t=1,e=0;e<this.chachelis.length;e++){var i=this.chachelis[e];i.available||(t=Math.max(t,i.x+i.w))}return t},minRows:function(){for(var t=1,e=0;e<this.chachelis.length;e++){var i=this.chachelis[e];i.available||(t=Math.max(t,i.y+i.h))}return t}}}},function(t,e,i){"use strict";e.a={name:"chacheli",props:["layout","chacheli","units"],computed:{style:function(){return{top:this.chacheli.y*this.units.v+"%",left:this.chacheli.x*this.units.h+"%",width:this.chacheli.w*this.units.h+"%",height:this.chacheli.h*this.units.v+"%"}}},methods:{mousedown:function(t,e){var i=document.defaultView.getComputedStyle(this.$el),n=document.defaultView.getComputedStyle(this.$refs.content);this.$emit(t,{chacheli:this.chacheli,event:e,initialPos:{left:parseFloat(i.getPropertyValue("left"))+parseFloat(i.getPropertyValue("padding-left"))+parseFloat(i.getPropertyValue("border-left-width")),top:parseFloat(i.getPropertyValue("top"))+parseFloat(i.getPropertyValue("padding-top"))+parseFloat(i.getPropertyValue("border-top-width")),width:parseFloat(n.getPropertyValue("width")),height:parseFloat(n.getPropertyValue("height"))}})},close:function(){this.chacheli.available=!0}}}},function(t,e,i){"use strict";e.a={name:"chacheli-chooser",props:["chachelis","dragging"],methods:{mousedown:function(t,e){var i=document.defaultView.getComputedStyle(e.target),n=e.target.getBoundingClientRect();this.dX=n.left-e.clientX,this.dY=n.top-e.clientY,this.dragElement=e.target,this.dragElement.style.width=parseFloat(i.width)+"px",this.dragElement.style.height=this.dragElement.parentElement.style.height=parseFloat(i.height)+"px",this.dragMove(e),document.documentElement.addEventListener("mousemove",this.dragMove,!1),document.documentElement.addEventListener("mouseup",this.dragStop,!1),document.documentElement.addEventListener("keydown",this.keyDown,!1),this.dragging.active=!0,this.dragging.cancelled=!1,this.dragging.index=t},keyDown:function(t){27===t.keyCode&&(this.dragging.cancelled=!0,this.dragStop())},dragMove:function(t){this.dragElement.style.left=t.clientX+this.dX+"px",this.dragElement.style.top=t.clientY+this.dY+"px"},dragStop:function(){document.documentElement.removeEventListener("mousemove",this.dragMove,!1),document.documentElement.removeEventListener("mouseup",this.dragStop,!1),document.documentElement.removeEventListener("keydown",this.keyDown,!1),this.dragElement.parentElement.removeAttribute("style"),this.dragElement.removeAttribute("style"),this.dragElement=null,this.dragging.active=!1}}}},function(t,e,i){"use strict";e.a={name:"chacheli-layout",props:["layout","chachelis","data"],data:function(){return{v:0,h:0}},watch:{"layout.cols":function(){this.calc()},"layout.rows":function(){this.calc()}},created:function(){this.calc()},methods:{calc:function(){this.v=100/this.layout.rows,this.h=100/this.layout.cols}}}},function(t,e,i){"use strict";function n(t){i(7)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),r=i(17),s=i(0),c=n,o=s(a.a,r.a,!1,c,"data-v-1b4b5ec2",null);e.default=o.exports},function(t,e){},function(t,e,i){"use strict";function n(t){i(9)}var a=i(2),r=i(13),s=i(0),c=n,o=s(a.a,r.a,!1,c,"data-v-28136716",null);e.a=o.exports},function(t,e){},function(t,e,i){"use strict";function n(t){i(11)}var a=i(3),r=i(12),s=i(0),c=n,o=s(a.a,r.a,!1,c,"data-v-49969dfa",null);e.a=o.exports},function(t,e){},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chacheli",style:t.style,on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:(e.preventDefault(),e.stopPropagation(),t.mousedown("drag",e))}}},[i("div",{ref:"content",staticClass:"content"},[t._v(t._s(t.chacheli.text))]),t._v(" "),i("div",{staticClass:"close",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.close(e)},mousedown:function(t){t.preventDefault(),t.stopPropagation()}}}),t._v(" "),i("div",{staticClass:"resize-handle",on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:(e.preventDefault(),e.stopPropagation(),t.mousedown("resize",e))}}})])},a=[],r={render:n,staticRenderFns:a};e.a=r},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chacheli-designer-layout",class:t.interactClass},[t._l(parseInt(t.layout.rows),function(e){return[t._l(parseInt(t.layout.cols),function(n){return[i("div",{key:e+"-"+n,staticClass:"grid",class:{right:n==t.layout.cols,bottom:e==t.layout.rows},style:{top:(e-1)*t.units.v+"%",left:(n-1)*t.units.h+"%",width:t.units.h+"%",height:t.units.v+"%"}},[t._t("default",null,{x:n-1,y:e-1})],2)]})]}),t._v(" "),t._l(t.chachelis,function(e){return e.available?t._e():i("chacheli",{key:e.id,attrs:{layout:t.layout,units:t.units,chacheli:e},on:{resize:t.resizeStart,drag:t.positionStart}})}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.placeholder.hidden,expression:"!placeholder.hidden"}],staticClass:"placeholder",class:{invalid:t.placeholder.invalid},style:t.placeholderStyle})],2)},a=[],r={render:n,staticRenderFns:a};e.a=r},function(t,e,i){"use strict";function n(t){i(15)}var a=i(4),r=i(16),s=i(0),c=n,o=s(a.a,r.a,!1,c,"data-v-b4999d6c",null);e.a=o.exports},function(t,e){},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chacheli-chooser"},[i("div",{staticClass:"inner"},t._l(t.chachelis,function(e,n){return e.available?i("div",{key:e.id,staticClass:"chacheli-outer"},[i("div",{staticClass:"chacheli",class:{dragging:t.dragging.active&&n===t.dragging.index},on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:(e.preventDefault(),e.stopPropagation(),t.mousedown(n,e))}}},[t._v("\n\t\t\t\t"+t._s(e.text)+"\n\t\t\t")])]):t._e()}),0)])},a=[],r={render:n,staticRenderFns:a};e.a=r},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chacheli-designer",class:{dragging:t.dragging.active}},[i("chacheli-designer-layout",{ref:"layoutComp",attrs:{layout:t.layout,chachelis:t.chachelis,dragging:t.dragging}}),t._v(" "),i("chacheli-chooser",{attrs:{chachelis:t.chachelis,dragging:t.dragging}})],1)},a=[],r={render:n,staticRenderFns:a};e.a=r},function(t,e,i){"use strict";function n(t){i(19)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(5),r=i(20),s=i(0),c=n,o=s(a.a,r.a,!1,c,"data-v-50cbf11f",null);e.default=o.exports},function(t,e){},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chacheli-layout"},t._l(t.chachelis,function(e){return e.available?t._e():i("div",{key:e.id,staticClass:"chacheli",style:{top:e.y*t.v+"%",left:e.x*t.h+"%",width:e.w*t.h+"%",height:e.h*t.v+"%"}},[i(e.comp,{tag:"component",attrs:{meta:e,data:t.data[e.id]}})],1)}),0)},a=[],r={render:n,staticRenderFns:a};e.a=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6),a=i(18);i.d(e,"ChacheliDesigner",function(){return n.default}),i.d(e,"ChacheliLayout",function(){return a.default}),e.default={install:function(t,e){t.component(n.default),t.component(a.default)}}}])});